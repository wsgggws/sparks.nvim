# Sparks.nvim

Neovim æ’ä»¶ï¼šæå…·æ‰“å‡»æ„Ÿçš„è¾“å…¥åŠ¨ç”»ç‰¹æ•ˆç³»ç»Ÿã€‚

**ğŸ‰ ç²’å­ç‰©ç†å¼•æ“ | ğŸ”¥ Combo è¿å‡»ç³»ç»Ÿ | ğŸ”Š æ²‰æµ¸å¼éŸ³æ•ˆ | ğŸŒˆ åŸºäº Treesitter çš„æ™ºèƒ½ç€è‰²**

> "å†™ä»£ç ä»æœªå¦‚æ­¤å¸¦æ„Ÿï¼"

<div align="center">
  <img src="assets/sparks-demo.gif" width="100%" />
</div>

## âœ¨ ç‰¹æ€§

- **âš›ï¸ ç‰©ç†ç²’å­ç³»ç»Ÿ**ï¼šåŸºäºé‡åŠ›ã€é˜»åŠ›å’Œåˆé€Ÿåº¦çš„å®æ—¶ç²’å­æ¨¡æ‹Ÿï¼Œæ‹’ç»å‘†æ¿çš„é¢„åˆ¶åŠ¨ç”»ã€‚
- **ğŸ”¥ Combo è¿å‡»ç³»ç»Ÿ**ï¼š
  - è¿ç»­è¾“å…¥ç§¯ç´¯çƒ­åº¦ï¼Œè§¦å‘ `x10` è¿å‡»æ˜¾ç¤ºã€‚
  - **çƒ­åº¦å‡çº§**ï¼šè¿å‡»æ•°è¶Šé«˜ï¼Œç‰¹æ•ˆè¶Šç‚«é…·ï¼ˆå½©è™¹æ¨¡å¼ ğŸŒˆ -> ç«ç„°æ¨¡å¼ ğŸ”¥ï¼‰ã€‚
- **ğŸ¨ æ™ºèƒ½ç€è‰²**ï¼šåˆ©ç”¨ Treesitter è‡ªåŠ¨è¯†åˆ«å½“å‰è¯­æ³•çš„é¢œè‰²ï¼Œè®©çƒŸèŠ±ä¸ä»£ç èä¸ºä¸€ä½“ã€‚
- **ğŸ’¥ å±å¹•éœ‡åŠ¨**ï¼šé«˜èƒ½æ—¶åˆ»è§¦å‘å±å¹•éœ‡åŠ¨ï¼Œæ‰“å‡»æ„Ÿæ‹‰æ»¡ï¼ˆå¯é€‰ï¼‰ã€‚
- **ğŸ“± è‡ªé€‚åº”å¸ƒå±€**ï¼š
  - æ ¹æ®çª—å£å¤§å°è‡ªåŠ¨è°ƒæ•´åŠ¨ç”»çª—å£å°ºå¯¸ï¼Œå®Œç¾é€‚é…å°å±/å¤§å±
  - å®æ—¶å“åº”çª—å£å¤§å°å˜åŒ–ï¼Œåˆ†å±è°ƒæ•´æ—¶è‡ªåŠ¨é‡æ–°å®šä½
  - åŠ¨ç”»çª—å£è·Ÿéšå½“å‰ç¼–è¾‘çª—å£ï¼Œåˆ‡æ¢çª—å£æ—¶è‡ªåŠ¨é€‚é…
- **ğŸ­ å¤šç§åŠ¨ç”»é¢„è®¾**ï¼š
  - `confetti` (å½©å¸¦) - é»˜è®¤è¾“å…¥
  - `explode` (çˆ†ç‚¸) - åˆ é™¤å­—ç¬¦
  - `matrix` (é»‘å®¢å¸å›½) - ç»¿è‰²ä»£ç é›¨
  - `snow` (é£é›ª) - èˆ’ç¼“é£˜è½
  - `rain` (é›¨æ»´) - è“è‰²é›¨å¸˜
  - `fizz` (æ°”æ³¡) - å‘ä¸Šå†’æ³¡
  - `fire` (ç«ç„°) - å‘ä¸Šå‡è…¾
  - `heart` (çˆ±å¿ƒ) - é£˜èµ·çš„çˆ±å¿ƒ
- **ğŸ”Š æ²‰æµ¸éŸ³æ•ˆ**ï¼š
  - é€šè¿‡ `sound_pack` ä¸€é”®åˆ‡æ¢éŸ³æ•ˆä¸»é¢˜ï¼ˆæœºæ¢°é”®ç›˜ã€ç§‘å¹»ç­‰ï¼‰
  - æ™ºèƒ½èŠ‚æµä¼˜åŒ–ï¼Œ80ms å†…ç›¸åŒéŸ³æ•ˆåªæ’­æ”¾ä¸€æ¬¡ï¼Œé¿å…å¡é¡¿
  - **macOS ä¸“å±ä¼˜åŒ–**ï¼šä½¿ç”¨ `afplay` å˜é€Ÿæ’­æ”¾ (+250% é€Ÿç‡)ï¼Œæ¨¡æ‹ŸæçŸ­ä¿ƒæœºæ¢°è½´æ‰‹æ„Ÿã€‚
- **âš¡ æè‡´æ€§èƒ½**ï¼š
  - **âœ¨ è§†è§‰æ·¡å‡º**ï¼šç²’å­ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ä¼šé€æ¸ç¼©å°å˜æ·¡ï¼Œç»†èŠ‚æ„Ÿæ‹‰æ»¡ã€‚
  - **ğŸ›¡ï¸ æ™ºèƒ½å±è”½**ï¼šè‡ªåŠ¨åœ¨ Telescopeã€NvimTreeã€Terminal ç­‰çª—å£ç¦ç”¨ï¼Œä¸“æ³¨æ ¸å¿ƒç¼–è¾‘ã€‚
  - **ğŸ§© æ™ºèƒ½å¤ç”¨**ï¼šå¤ç”¨çª—å£ã€Paste æ¨¡å¼æ£€æµ‹ã€å®å½•åˆ¶æ£€æµ‹ï¼Œé›¶å¹²æ‰°ã€‚

## ğŸ“¦ å®‰è£…

### LazyVim / lazy.nvim

```lua
{
  "wsgggws/sparks.nvim",
  event = "VeryLazy",
  opts = {
    -- ğŸš€ é»˜è®¤å·²å¯ç”¨æ‰€æœ‰æœ€ä½³é…ç½®
  },
}
```

## âš™ï¸ é…ç½®æ‰‹å†Œ

```lua
require("sparks").setup({
  -- åŸºç¡€å¼€å…³
  enabled = true,
  position = "top-right", -- åŠ¨ç”»æ˜¾ç¤ºä½ç½®ï¼ˆä¼šæ ¹æ®å±å¹•å¤§å°è‡ªåŠ¨è°ƒæ•´ï¼‰

  -- ğŸš€ ç‰©ç†ç²’å­ç³»ç»Ÿé…ç½®
  animation_fps = 30,     -- å¸§ç‡ (å»ºè®® 30-60)
  default_effect = "confetti", -- é»˜è®¤ç‰¹æ•ˆ (å½“å­—ç¬¦ä¸åœ¨ triggers ä¸­æ—¶ä½¿ç”¨)

  -- ğŸ”¥ Combo ç³»ç»Ÿ
  enable_combo = true,
  combo_threshold = 1,    -- å¤šå°‘è¿å‡»å¼€å§‹æ˜¾ç¤ºè®¡æ•°
  combo_timeout = 400,    -- è¿å‡»æ–­å¼€æ—¶é—´(ms)

  -- çƒ­åº¦æ˜ å°„ï¼šè¿å‡»æ•° -> ç‰¹æ•ˆæ¨¡å¼
  heat_map = {
    [10] = "rainbow", -- >10 è¿å‡»ï¼šä¸ƒå½©ç²’å­
    [20] = "fire",    -- >20 è¿å‡»ï¼šç«ç„°å‡è…¾
  },

  -- ğŸ«¨ æ‰“å‡»æ„Ÿ
  enable_shake = true,    -- è¿å‡»çˆ†å‘æ—¶çª—å£éœ‡åŠ¨

  -- è¾“å…¥/åˆ é™¤ç‰¹æ•ˆå¼€å…³
  show_on_insert = true,  -- è¾“å…¥å­—ç¬¦æ—¶æ˜¾ç¤ºåŠ¨ç”»
  show_on_delete = true,  -- åˆ é™¤å­—ç¬¦æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼ˆä»…æ’å…¥æ¨¡å¼ï¼‰

  -- åŠ¨ç”»é¢„è®¾
  -- åŸºç¡€: confetti, explode, matrix, snow, rain, fizz, fire, heart, sparkle

  -- âŒ¨ï¸ é«˜çº§è§¦å‘å™¨ (æŒ‰é”® -> åŠ¨ç”»ç±»å‹)
  triggers = {
    ["{"] = "explode",   -- çˆ†ç‚¸
    ["("] = "confetti",  -- å½©å¸¦
    ["["] = "matrix",    -- é»‘å®¢å¸å›½
    ["!"] = "explode",   -- çˆ†ç‚¸
    ["?"] = "sparkle",   -- é—ªçƒ
    ["="] = "fizz",      -- æ°”æ³¡
    [";"] = "rain",      -- é›¨æ»´
    [":"] = "rain",      -- é›¨æ»´
    ["+"] = "fire",      -- ç«ç„°
    ["<"] = "heart",     -- çˆ±å¿ƒ
    ["%"] = "confetti",  -- å½©å¸¦
  },

  -- ğŸ”Š å£°éŸ³é…ç½®
  enable_sound = true,    -- å¯ç”¨å£°éŸ³
  sound_on_insert = true, -- è¾“å…¥æ—¶æ’­æ”¾å£°éŸ³
  sound_on_delete = true, -- åˆ é™¤æ—¶æ’­æ”¾å£°éŸ³
  sound_volume = 5.0,     -- éŸ³é‡ (0.0 - 5.0)
  sound_pack = "default", -- default, mechanical, sci-fi
  -- å£°éŸ³ä¼šè‡ªåŠ¨èŠ‚æµï¼ˆ80msï¼‰ï¼Œé¿å…å¿«é€Ÿæ“ä½œæ—¶å¡é¡¿

  -- ğŸ›¡ï¸ æ™ºèƒ½å±è”½ (åˆ—è¡¨ä¸­çš„çª—å£ä¸è§¦å‘åŠ¨ç”»)
  excluded_filetypes = {
    "TelescopePrompt",
    "NvimTree",
    "neo-tree",
    "lazy",
    "mason",
  },
  excluded_buftypes = { "nofile", "terminal", "prompt" },

  -- å¤–è§‚
  winblend = 0,           -- çª—å£é€æ˜åº¦(0-100)ï¼Œé»˜è®¤ 0ã€‚è®¾ç½® > 0 ä»¥é€å‡ºå…‰æ ‡è¡ŒèƒŒæ™¯
})
```

## ğŸ® å‘½ä»¤

- `:SparksToggle` - åˆ‡æ¢æ’ä»¶å¼€å…³
- `:SparksTest` - æµ‹è¯•åŠ¨ç”»æ•ˆæœ
- `:checkhealth sparks` - è¯Šæ–­é…ç½®å¥åº·çŠ¶æ€

## ğŸ”Š å£°éŸ³æ”¯æŒ

- **macOS**: `afplay`
- **Linux**: `paplay` (PulseAudio), `aplay` (ALSA)
- **Windows**: PowerShell SoundPlayer

```lua
opts = {
  enable_sound = true,
  sound_file_insert = { "C:\\Windows\\Media\\Windows Ding.wav" },
  sound_file_delete = { "C:\\Windows\\Media\\Windows Error.wav" },
}
```

### Linux ç”¨æˆ·é…ç½®ç¤ºä¾‹

```lua
opts = {
  enable_sound = true,
  -- ä½¿ç”¨ freedesktop éŸ³æ•ˆæˆ–è‡ªå·±çš„éŸ³é¢‘æ–‡ä»¶
  sound_file_insert = { "/usr/share/sounds/freedesktop/stereo/message.oga" },
  sound_file_delete = { "/usr/share/sounds/freedesktop/stereo/bell.oga" },
}
```

**æ³¨æ„**:

- å£°éŸ³é»˜è®¤å…³é—­ï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½® `enable_sound = true`
- å¦‚æœä¸é…ç½®å£°éŸ³æ–‡ä»¶ï¼Œå°†è‡ªåŠ¨ä½¿ç”¨ç³»ç»Ÿé»˜è®¤éŸ³æ•ˆ
- æ”¯æŒå¤šä¸ªå£°éŸ³æ–‡ä»¶ï¼Œæ¯æ¬¡éšæœºæ’­æ”¾å¢åŠ è¶£å‘³æ€§
- å»ºè®®æˆ´è€³æœºä½¿ç”¨ï¼ŒéŸ³é‡ä¸å®œè¿‡å¤§

## ğŸ¨ è‡ªå®šä¹‰æ ·å¼

åŠ¨ç”»ä½¿ç”¨çš„é«˜äº®ç»„ï¼š

- è¾“å…¥ï¼š`String`
- åˆ é™¤ï¼š`WarningMsg`

å¯é€šè¿‡è®¾ç½®è¿™äº›é«˜äº®ç»„æ¥è‡ªå®šä¹‰é¢œè‰²ã€‚

**æç¤º**ï¼šå¦‚æœä½ å‘ç°åŠ¨ç”»çª—å£èƒŒæ™¯é®æŒ¡äº†å…‰æ ‡è¡Œé«˜äº®ï¼ˆCursorLineï¼‰ï¼Œå¯ä»¥åœ¨é…ç½®ä¸­è®¾ç½® `winblend = 10` æˆ–æ›´é«˜ï¼Œæ¥å¼€å¯é€æ˜æ•ˆæœã€‚

## ğŸš€ æ€§èƒ½

- ä½¿ç”¨èŠ‚æµæœºåˆ¶é¿å…é¢‘ç¹è§¦å‘ï¼ˆè¾“å…¥èŠ‚æµ 100msï¼Œå£°éŸ³èŠ‚æµ 50msï¼‰
- å¼‚æ­¥çª—å£ç®¡ç†ï¼Œä¸é˜»å¡ç¼–è¾‘
- è‡ªåŠ¨æ¸…ç†èµ„æº
- **è‡ªé€‚åº”çª—å£å°ºå¯¸**ï¼š
  - æ ¹æ®çª—å£å®½åº¦å®æ—¶è°ƒæ•´å¤§å°ï¼š
    - å°çª—å£ (< 40 åˆ—)ï¼š16x8 çª—å£
    - ä¸­ç­‰çª—å£ (40-60 åˆ—)ï¼š20x10 çª—å£
    - å¤§çª—å£ (> 60 åˆ—)ï¼š26x12 çª—å£
  - çª—å£å¤§å°å˜åŒ–æ—¶è‡ªåŠ¨é‡æ–°å®šä½
  - åˆ‡æ¢ç¼–è¾‘çª—å£æ—¶è‡ªåŠ¨é€‚é…æ–°çª—å£

## ğŸ“„ License

MIT
